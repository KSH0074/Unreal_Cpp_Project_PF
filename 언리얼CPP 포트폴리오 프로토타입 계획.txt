프로토타입 세부사항 : 

임시 캐릭터는 언리얼에서 제공하는Character Modeling 사용 

커맨드 저장했다 기술표랑 비교해서 맞는 기술을 보여야 하는데 

캐릭터에 붙어야 하는 컴포넌트, 
movement(기본)/ 카메라/ 스프링암 

------------------------------------------------------------------------------------
커맨드 입력 알고리즘? 
커맨드 핸들러가 필요하지 않을까 

키 입력 ->일정시간 지나면(0.5초?) 자동 휘발 
입력과 동시에 타이머 재생, 다음 키 입력시 타이머 초기화(갱신), 좌 클릭시 

커맨드 입력처리 => 기술표에 없으면 => False 
				     있는경우 => 맞는 기술 발사 

Queue으로 커맨드 입력을 받아서 데이터 테이블과 비교, 있으면 기술 사용, 

트라이(Trie 알고리즘) 사용? 아니면 배열 비교 형식으로? 흐으음 
그러면 기술표는 어떻게 만드는가?  

https://awayteamkiller.tistory.com/2 
이것을 참고해서 만들어 볼까? 

기술 1: ....
기술 2: ....
기술 3: ....
기술 4: ....
리스트를 파일로 가지고 있다가 로딩하여 쓰기
or 
CSV 파일을 따로 만들었다 로드하여 사용?? 
해시테이블-> map 으로 사용
언리얼에서 표를 얼마나 지원하는 지 보고 결정해봐야 할 듯  

이 부분에서 많은 시간이 소요될 듯?   => 생각보다 일찍 끝났다.. 

각 레벨별 데미지 추가하기 => TABLE 또는 그래프 이용 
---------------------------------------------------------------------------------------
적 FSM 제작 및 BB를 이용해서 AI가 컨트롤 하도록 함,
랜덤 패트롤 => 시야 내 플레이어 탐지 => 달려오기 => 공격 

FSM을 추가하던가 아무튼 피격효과도 추가해야함 
피격 모션도 있어야 함

커맨드 입력후 애니메이션 작동중에는 커맨드 아웃풋 안되게 해야 함 

capsule은 피격, 

Fireball 데미지를 Table에서 가져올 수 있도록함

FSM을 추가하던가 아무튼 피격효과도 추가해야함 => FSM대신 BehaviorTree를 이용해 구현됨. 일단 0.5초 정지로 .. 


이제 Enemy의 health가 0이하로 되었을때 사라지는 효과 조정 => 일단 밑으로 사라지도록 함 
스텐실 버퍼? 를 이용해서 벽 뒤에 있을 때 플레이어 보이게 하기  or 벽이 투명해지던가 하기 => 씬 뎁스를 이용해서 구현 가능할 것 같음 =>일단 보류



피격 모션도 있어야 함-> 일단 피격후 0.5초간 정지하도록 구현하였고 이 시간동안 피격 애니메이션 작동하도록 만들어야 하는데..  



의문 : 프로토타입 / 알파 / 베타 버전을 구분하는 것이 의미있는 행위인가? 


FireBall을 관통공격으로 만들어야 할까? => yes 이지만 일단 나중에 
-----------------------------------
*중간 정리*

0-5.thisPointer 대체 및 피드백 내용 적용 
※피드백 내용 적용중 발견한 Behavior Tree 의 큰 기술적 부채를 발견,
BT/ BB 에서 Is too far 의 Bool 값이 유지가 되어야 하는데 계속 True 로 돌아가는 문제를 해결해야 코드가 간결해질 가능성이 높다. 또한 Enemy가 피격되면 플레이어를 쫓아가는 부분 또한 비슷한 방법으로 해결 될 듯 싶음, 이 기술적 부채의 큰 이유는 주먹구구식으로 제대로 배우지 않고 BT/BTT 등을 코드로 구현하려다 생긴 것  

1.Enemy 공격구현, 애니메이션은 아니더라도 공격을 한다는 함수 만들어서 작동되는지, BehaviorTree에 추가구현, (조건 : 거리, float) 
2.레벨별 기술 데미지 구현(커맨드 Csv파일을 수정해야할 듯)
3.이동지점 표시 (생각해보니 되게 독립적인 기능=> 앞으로 개발 순서에 상관없이 구현가능함 ) 
...

를 해결하고 난 이후 생각해야하는 것 
1.공격, 피격 판정 및 모션 =>공격 애니메이션에 notify로 피격, 공격 판정? 공격은 Skeletal 메시에 콜리전 구성해서 만들어야 하나? 피격 모션 중에 맞으면 피격처리를 해야하나?
공격 모션 중간(적당히 알맞은 부분)에 콜리전 충돌 판정이 켜지는 방식이어야 하나? ++ 

1-2.공격 애니메이션 작동중에는 커맨드 아웃풋 안되게 해야 함 
-> 함수에 bool형을 받는 매개변수를 달기 또는  애니메이션 노티파이로 구현해야하지 않을까(if문 사용해서 애니메이션 끝남 판정?), 이 게임에 선입력 시스템이 존재해야 하는가? =>yes 

2.UX/UI =>Esc 누르면 초기화면으로 갈지 설정을 조정할지 떠야하고 이때 시간은 멈추고 커맨드, 이동 관련된 입력은 중지되어야 한다.

3.레벨디자인? => 랜드스케이프 모드, 마켓플레이스 무료 콘텐츠 뒤지다 보면 쓸만한게 나오겠지... 별도의 프로젝트에 받고 필요한 콘텐츠만 이주하여 만들기, 일단 1개만  

4.초기화면 (시작 , 설정 , 등등 ) 

5.모듈화(?), 리팩토링 (및 기술적 부채 해결)

6.카메라 무빙 관련 조정 if 벽 투시효과 주지 않는경우  

추가를 고려하고 있는 사항  
1.Save/Load
2.커스텀 뎁스(?)사용해서 투시효과 주기 
3.FireBall이 시간이 아닌 날아간 거리에 따라 delete되도록 함//근데 거리 = 시간 * 속력 이므로 큰 차이없어보이나 유지보수에 용이할 것으로 판단, 다른 게임들 보면 투사 공격은 소멸판정이 거리이므로 플레이어가 좀더 직관적으로 판단 가능할 것으로 사료됨 
4.몬스터 헌터, 다크소울과 같은 패턴형 공격을 하는 보스 몹 (유니티로 만든 적이 있으나 언리얼 엔진 기능 사용이 아직 미숙하므로 난항이 예상됨)
5.공격 유형별 몹 피격반응 (애니메이션 다양하게 필요함 ...)
6.사운드(소스 구하기 힘들어 보임)
7.미니맵<-어렵진 않아보임 (별도의 이미지 파일 없이) 
8.포스트프로세스 

--------------------------------------------------------------------------
피드백 결과 

1. 코드정리 필요 함수 디폴트 리턴 (설명을 이해 못함?) 
2. thispointer 자제하기 (23/05/24 해결)
3.옵션 지정 >> ?? 아마도 일부 함수에서 옵션을 다 안쓰고 디폴트 매개변수로 때운 듯? UE4 Document 확인하면서 다시 작성해보기  
4.코드사용 => 사용할거면 완전하게, 애매하면 지우기 => 어느 부분인지? 모르겠지만 일단 코드 다시 살펴보면서 수정해보기 짚히는건 억지로 Blueprint에 넣은 C++함수 (추후 AI 재정리하면서 해결)
5.어떤 게임인지 흐름이 모르겠다, 왜 액션? 정리가 필요하다  => 전체계획 파일 세부화 작성 (설명 파일 추가로 해결되었을 것)
---------------------------------------------------------
2023-07-06 이후 작성된 부분 

포트폴리오의 진도 및 의욕 향상을 위해 피드백 내용은 최종적으로 적용하는 것으로 함
일단 애니메이션 관련 작업부터 시작하여 기본적인 기능을 먼저 완성하는 것이 목표


Mixamo에서 캐릭터를 다운받아 사용, Mixamo 캐릭터 Rig을 기준으로 Unreal기본 캐릭터 Animation 리타기팅 
Mixamo Character<<Retargetting<<UE4_Mannequin_Skeleton Rigging 기반 애니메이션 

>> 게임내 사용되는 캐릭터는 Mixamo에서 받은 캐릭터, 이를 기준으로 애니메이션을 적용한다. 

Mixamo 캐릭터를 Blender를 통해 UnrealEngine 에 맞게 변환하는 과정이 제대로 이루어지지 않아
휴머노이드 리타기팅은 수동으로 한다. 

필요한 애니메이션 모션 

Enemy(normal mob) : 피격 , 공격 , 이동(새로운 모션을 구하여 추가하면 좋다. 여력이 되지 않을 경우 기본 애니메이션을 사용한다)

Player : 공통구현사항 스킬 사용중에는 이동이 멈춰야함 
- fire ball, 일명 아도겐 모션, 구할 수 없으면 다른 투사체 발사 모션으로 대체한다, 커맨드리스트에 JangPoong으로 되어있으므로 추후 명칭 통합해야한다. 해당 애니메이션을 적당히 잘라서 
 투사체 생성과 애니메이션을 자연스럽게 만들어야 함, 투사체 생성 타이밍을 맞추기 힘들경우 애니메이션 노티파이 기능 사용을 해야할 것.

- Hold 애니메이션은 개발역량 부족으로 다른 기술로 대체 , 일반 몹을 잡고 던지는 격투게임같은 동작, 역량도 떨어질 뿐더러 개발 방향성과 부적합, 
  게임 로스트아크의 컨텐츠 카오스던전을 레퍼런스 삼아 개발 중이다. 다른 공격 스킬 모션으로 대체한다. 빠르게 이동하여 공격하는 종류가 좋을 것


- Dodge 애니메이션, 회피 애니메이션으로, 해당 동작중엔 피격판정이 없어야 한다. 가장 구하기 쉬운 애니메이션이다. 루트모션이다.

위를 베이스애니메이션이라 하고 
추후 바리에이션을 추가할 때 경우에따라 추가된다.

Enemy 와 Player가 같은 Rig을 공유하므로 애니메이션 적용및 추가에 착오가 없도록 주의할 것 

위 애니메이션을 적용하면, Enemy의 AI에 공격 패턴을 추가한다. 
이때 공격판정 범위는 공격 애니메이션을 기준으로 한다.


Enemy의 AI 중 탐지거리 밖에서 공격하는 경우에도 플레이어를 추적하도록 해야한다. 
따라서 Enemy AI 재정비 필요하다

Enemy AI 요구사항.

- player가 전방에서(Enemy의 앞에서) 가까운 거리에 있는경우 추적한다. 
- player가 어디에서든 공격할 경우 추적한다.
	-위 두 사항에서 추적한 지 오랫동안 공격을 하지 못하면 초기 위치로 빠르게 돌아간다. 이때 피격당하지 않는다.
 
- 평상시에는 특정 범위 내에서 랜덤하게(굳이 랜덤하지 않아도 좋다) 패트롤 한다.
- Player가 가까이 있는 경우 근접 공격을 한다.

현재 Enemy AI의 요구사항에 비해 BehaviorTree가 과하게 복잡해 보인다.


